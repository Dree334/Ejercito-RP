<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>S.U.K.V. V4.0 - Sanciones</title>
    <style>
        body { background-color: #020814; color: white; font-family: sans-serif; padding: 20px; }
        .registro-box { border: 1px solid #1a2a44; padding: 15px; width: 350px; margin-bottom: 20px; background: #050d1d; }
        input, textarea { width: 90%; margin-bottom: 10px; padding: 8px; background: #0a1629; border: 1px solid #1e3a5f; color: white; }
        button { background: #1e3a5f; color: white; border: none; padding: 10px; cursor: pointer; width: 95%; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #0a1629; color: #4eef3a; padding: 10px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #112244; }
    </style>
</head>
<body>

    <h2>ADMINISTRACIÓN DE SANCIONES</h2>

    <div class="registro-box">
        <input type="text" id="nombre_ic" placeholder="Nombre IC">
        <input type="text" id="placa" placeholder="Placa">
        <input type="text" id="discord" placeholder="Nombre Discord">
        <textarea id="motivo" placeholder="Motivo de la sanción"></textarea>
        <button onclick="ejecutarSancion()">REGISTRAR SANCIÓN</button>
    </div>

    <table border="1">
        <thead>
            <tr>
                <th>SOLDADO</th>
                <th>PLACA</th>
                <th>NIVEL</th>
                <th>FECHA</th>
            </tr>
        </thead>
        <tbody id="tabla-registros">
            </tbody>
    </table>

    <script>
        async function cargarRegistros() {
            try {
                const res = await fetch('/api/sancionar');
                const datos = await res.json();
                const tabla = document.getElementById('tabla-registros');
                tabla.innerHTML = "";

                datos.forEach(s => {
                    tabla.innerHTML += `
                        <tr>
                            <td>${s.nombre_ic}</td>
                            <td>${s.placa}</td>
                            <td style="color:red;">STRIKE ${s.nivel}</td>
                            <td>${s.fecha}</td>
                        </tr>`;
                });
            } catch (e) { console.error("Error al cargar tabla."); }
        }

        async function ejecutarSancion() {
            const payload = {
                nombre_ic: document.getElementById('nombre_ic').value,
                placa: document.getElementById('placa').value,
                discord: document.getElementById('discord').value,
                nivel: 3,
                motivo: document.getElementById('motivo').value,
                fecha: new Date().toLocaleDateString('es-CO')
            };

            const res = await fetch('/api/sancionar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (res.ok) {
                alert("✅ Sanción Enviada");
                cargarRegistros();
            } else {
                alert("❌ Fallo en Servidor");
            }
        }

        document.addEventListener('DOMContentLoaded', cargarRegistros);
    </script>
</body>
</html>
