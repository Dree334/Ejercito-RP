<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>S.U.K.V. V4.0</title>
    <style>
        body { background: #020814; color: white; font-family: sans-serif; padding: 20px; }
        input, textarea { width: 300px; display: block; margin-bottom: 10px; padding: 10px; background: #0a1629; border: 1px solid #1e3a5f; color: white; }
        button { background: #1e3a5f; color: white; padding: 10px 20px; border: none; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border-bottom: 1px solid #1a2a44; text-align: left; }
    </style>
</head>
<body>

    <h3>REGISTRO DE STRIKE</h3>
    <input type="text" id="nombre_ic" placeholder="Nombre IC">
    <input type="text" id="placa" placeholder="Placa">
    <input type="text" id="discord" placeholder="ID Discord">
    <textarea id="motivo" placeholder="Motivo"></textarea>
    <button onclick="ejecutarSancion()">ENVIAR SANCIÓN</button>

    <table>
        <thead>
            <tr><th>SOLDADO</th><th>PLACA</th><th>ESTADO</th><th>FECHA</th></tr>
        </thead>
        <tbody id="tabla-cuerpo"></tbody>
    </table>

    <script>
        async function cargarRegistros() {
            try {
                // Ruta ajustada a /sancionar
                const res = await fetch('/sancionar');
                const data = await res.json();
                const tabla = document.getElementById('tabla-cuerpo');
                tabla.innerHTML = "";
                data.forEach(s => {
                    tabla.innerHTML += `<tr><td>${s.nombre_ic}</td><td>${s.placa}</td><td style="color:red">STRIKE ${s.nivel}</td><td>${s.fecha}</td></tr>`;
                });
            } catch (e) { console.error("Error al cargar"); }
        }

        async function ejecutarSancion() {
            const payload = {
                nombre_ic: document.getElementById('nombre_ic').value,
                placa: document.getElementById('placa').value,
                discord: document.getElementById('discord').value,
                motivo: document.getElementById('motivo').value,
                fecha: new Date().toLocaleDateString('es-CO')
            };

            const res = await fetch('/sancionar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (res.ok) {
                alert("✅ Sanción registrada");
                cargarRegistros();
            } else {
                const err = await res.json();
                alert("❌ Error: " + err.error);
            }
        }
        document.addEventListener('DOMContentLoaded', cargarRegistros);
    </script>
</body>
</html>
